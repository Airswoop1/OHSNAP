angular.module("formApp.documentUploadCtrl",["formApp.ngDocumentFullscreen","formApp.DocumentUploader","formApp.userDataFactory","formApp.sampleDocumentsDirective"]).controller("documentUploadCtrl",["$scope","$upload","$state","$stateParams","$rootScope","$location","$window","documentUpload","userDataFactory",function($scope,$upload,$state,$stateParams,$rootScope,$location,$window,documentUpload,userDataFactory){$scope.docs=userDataFactory.userData.docs,$scope.docProgress=userDataFactory.userData.docProgress,$scope.user="undefined"!=typeof userDataFactory.userData.user.formData?userDataFactory.userData.user.formData:{},$scope.date=new Date,$scope.date_of_interview=new Date,$scope.date_of_interview.setDate($scope.date.getDate()+10),$scope.DOC_STATUS={UPLOADED:2,IN_PROGRESS:1,NOT_UPLOADED:0},$scope.localDocs={IDENTITY:0,RESIDENCE:0,HOUSEHOLD_COMPOSITION:0,AGE:0,SSN:0,CITIZENSHIP:0,ALIEN_STATUS:0,EARNED_INCOME:0,ALT_INCOME:0,RESOURCES:0},$scope.current_type=$state.params.type,$scope.docSafetyOpen=!1,$rootScope.$on("$stateChangeStart",function(event,toState,toParams){toParams&&($scope.current_type=toParams.type)}),$scope.renderImg=function(type,url){$scope.localDocs[type]=url},$scope.isNotUploaded=function(name){return $scope.docs[name]===$scope.DOC_STATUS.NOT_UPLOADED},$scope.isInProgress=function(name){return $scope.docs[name]===$scope.DOC_STATUS.IN_PROGRESS},$scope.isUploaded=function(name){return $scope.docs[name]===$scope.DOC_STATUS.UPLOADED},$scope.goToDocUpload=function(name){$state.go("upload.detail",{type:name})},$scope.goToCompletion=function(){$state.go("upload.completion",{type:"Completion"})},$scope.getCurrentContent=function(){var type=$state.params.type;return $scope.current_sample_image=$scope.docContent[type].sample_image,$scope.docContent[type].header},$scope.getDocDetailState=function(){return $scope.docs[$state.params.type]},$scope.getCurrentType=function(){return"ALT_INCOME"==$state.params.type?"OTHER INCOME":"EARNED_INCOME"==$state.params.type?"INCOME":"HOUSING_EXPENSE"==$state.params.type?"HOUSING EXPENSES":$state.params.type?$state.params.type:"Documents"},$scope.uploadFile=function($files){var type=$state.params.type;$scope.docs[type]=$scope.DOC_STATUS.IN_PROGRESS,$scope.uploadProgress(type),console.log($files),documentUpload.onFileSelect($files,$scope,type,$scope.user.user_id).then(function(){$scope.docProgress[type]=100,$scope.docs[type]=$scope.DOC_STATUS.UPLOADED},function(){$scope.docs[type]=$scope.DOC_STATUS.NOT_UPLOADED,alert("Sorry we were unable to upload your documents, please try again")})},$scope.uploadProgress=function(type){$scope.docProgress[type]+=10;var upload=setInterval(function(){$scope.docProgress[type]<100&&$scope.docs[type]!==$scope.DOC_STATUS.UPLOADED?$scope.docProgress[type]+=10:($scope.docProgress[type]=100,clearInterval(upload))},50)},$scope.updateUploadedFilesStatus=function(data){var status=data.status;if(status)for(var uploaded in status)status.hasOwnProperty(uploaded)&&($scope.docs[uploaded]=status[uploaded])},$window.onbeforeunload=function(){var message="Your documents are still uploading! If you leave now they won't be submitted.";return $scope.docStillUploading()?("undefined"==typeof event&&(event=window.event),event&&(event.returnValue=message),message):null},$scope.docStillUploading=function(){var uploading=!1;for(var x in $scope.docs)uploading=uploading||$scope.docs[x]===$scope.DOC_STATUS.IN_PROGRESS;return uploading},$scope.docContent={IDENTITY:{header:"Take a picture of 1 of these documents to confirm your identity.",sample_image:"sample_id.png",valid_docs:[{name:"Drivers license or state photo ID",image:"sample_dl.jpg",link:"http://dmv.ny.gov/driver-license/get-driver-license"},{name:"US Passport",image:"sample_passport.jpg",link:"https://www.usps.com/shop/apply-for-a-passport.htm"}]},RESIDENCE:{header:"Take a picture of 1 of these documents to confirm where you live.",sample_image:"sample_address.png",valid_docs:[{name:"Lease",image:"sample_lease.jpg",link:"http://www.ehow.com/how_6147098_request-copy-apartment-lease-mail.html"},{name:"Statement from landlord or primary tenant",image:"sample_addressstatement.jpg",link:"http://www.wikihow.com/Write-a-Letter-Showing-Proof-of-Residence-for-a-Tenant"},{name:"Mortgage record",image:"sample_mortgagerecord.jpg",link:"http://a836-acris.nyc.gov/CP/"}]},HOUSING_EXPENSE:{header:"Take a picture of 1 of these documents to confirm how much you pay for housing.",sample_image:"sample_housingexpense.png",valid_docs:[{name:"Lease, if you do not split the rent",image:"sample_lease.jpg",link:"http://www.ehow.com/how_6147098_request-copy-apartment-lease-mail.html"},{name:"Rent receipt, if you do not split the rent",image:"sample_rentreceipt.jpg",link:"http://www.masslegalhelp.org/housing/private-housing/ch3/security-deposit-landlords-responsiblities"},{name:"Statement from roommates, if you split the rent",image:"sample_housingstatement.jpg",link:"http://www.lawdepot.com/contracts/roommate-agreement/"}]},HOUSEHOLD_COMPOSITION:{header:"Take a picture of 1 of these documents to prove who lives with you.",sample_image:"sample_household.png",valid_docs:[{name:"Statement from your landlord",image:"sample_addressstatement.jpg",link:"http://www.wikihow.com/Write-a-Letter-Showing-Proof-of-Residence-for-a-Tenant"},{name:"School records",image:"sample_schoolrecord.jpg",link:"http://www1.nyc.gov/nyc-resources/service/2557/student-record-request"}]},UTILITIES:{header:"Take a picture of 1 of these documents to confirm utilities you pay for separate from rent.",sample_image:"sample_utilities.png",valid_docs:[{name:"Utility bill",image:"sample_utility.jpg"},{name:"Telephone bill",image:"sample_phonebill.jpg"}]},SSN:{header:"Take a picture of 1 of these documents to confirm your Social Security Number.",sample_image:"sample_ssn.png",valid_docs:[{name:"Social Security Card",image:"sample_ssn.jpg",link:"http://www.nyc.gov/html/id/html/how/social_security_card.shtml"},{name:"Official mail from the SSA",image:"sample_ssamail.jpg"}]},CITIZENSHIP:{header:"Take a picture of one of these documents to confirm your citizenship status.",sample_image:"sample_citizen.png",valid_docs:[{name:"US Passport",image:"sample_passport.jpg",link:"https://www.usps.com/shop/apply-for-a-passport.htm"},{name:"US Birth Certificate",image:"sample_birth_cert.jpg",link:"http://www.nyc.gov/html/id/html/how/birth_certificate.shtml"},{name:"US Military service record",image:"sample_military.jpg",link:"http://themilitarywallet.com/how-to-get-a-military-id-card/"},{name:"Naturalization Certificate",image:"sample_naturalization.jpg",link:"http://www.uscis.gov/tools/how-do-i-customer-guides/how-do-i-guides-us-citizens/how-do-i-obtain-certified-true-copies-certificate-naturalization"}]},EARNED_INCOME:{header:"Take a picture of 1 of these documents to confirm income that you've earned.",sample_image:"sample_income.png",valid_docs:[{name:"Pay stub",image:"sample_paystub.jpg",link:"http://www.ehow.com/how_8353804_copy-pay-stubs.html"},{name:"Tax return",image:"sample_taxreturn.jpg",link:"http://www.irs.gov/Individuals/Get-Transcript"},{name:"Statement from employer",image:"sample_incomestatement.jpg",link:"hhttp://www.wikihow.com/Write-a-Letter-for-Proof-of-Income"},{name:"Invoice, if you are self-employed",image:"sample_invoice.jpg"}]},ALT_INCOME:{header:"Take a picture of 1 of these documents to confirm alternate sources of income.",sample_image:"sample_altincome.png",valid_docs:[{name:"Current unemployment award certificate",image:"sample_unemploymentcert.jpg",link:"http://www.ehow.com/how_8421455_do-proof-unemployment.html"},{name:"Current Social Security benefit check",image:"sample_sscheck.jpg",link:"http://www.ssa.gov/pubs/EN-05-10552.pdf"},{name:"Statement from person paying child support",image:"empty.jpg",link:"http://info.legalzoom.com/evidence-child-support-payments-23480.html"},{name:"Check stubs from child support",image:"empty.jpg",link:"http://info.legalzoom.com/evidence-child-support-payments-23480.html"},{name:"Current veteran's benefit check",image:"empty.jpg"},{name:"Current worker's compensation certificate",image:"sample_workerscompcert.jpg"}]},OTHER:{header:"Take a picture of 1 of these documents to confirm alternate sources of income.",sample_image:"sample_utilities.png",valid_docs:[]}},$scope.goBack=function(){window.history.back()}}]),angular.module("formApp.formController",["angularFileUpload","ui.router","ui.bootstrap","ngTouch","NoContactModal","formApp.CalcBenefitService","formApp.infoFooterDirective","formApp.ngEnterDirective","formApp.telephoneFilter","formApp.ssnFilter","formApp.apiFactory","formApp.appSubmittedDropdownDirective","formApp.feedbackFooterDirective","formApp.modalDirective","formApp.documentUploadCtrl","formApp.userDataFactory"]).controller("formController",["$scope","$state","$http","$rootScope","$upload","$location","$window","API","userDataFactory","calcBenefitService",function($scope,$state,$http,$rootScope,$upload,$location,$window,API,userDataFactory,calcBenefitService){function calcPotentialImmeditateBenefit(){return $scope.formData.total_resources<=100||$scope.formData.income<=150||$scope.formData.income+$scope.formData.total_resources<=$scope.formData.expenses}function showNoContactModal(){$scope.modalShown=!0}function updateProgress(u){$scope.completed_items[u]=!0,$scope.progress=0;for(var comp in $scope.completed_items)$scope.completed_items[comp]&&($scope.progress+=12.5)}function updateEligibilityProgress(u){$scope.eligibilityCompleted[u]=!0,$scope.eligibility_progress=0;for(var comp in $scope.eligibilityCompleted)$scope.eligibilityCompleted[comp]&&($scope.eligibility_progress+=20)}$scope.formData=userDataFactory.userData.user.formData,$scope.progress=0,$scope.date=new Date,$scope.date_of_interview=new Date,$scope.date_of_interview.setDate($scope.date.getDate()+10),$scope.date_of_phone_call=new Date,$scope.date_of_phone_call.setDate($scope.date.getDate()+7),$scope.basic_confirmation_agree=!1,$scope.submitted_name=!1,$scope.submitted_address=!1,$scope.submitted_phone=!1,$scope.submitted_income=!1,$scope.submitted_household=!1,$scope.submitted_expenses=!1,$scope.has_phone=!0,$scope.has_address=!0,$scope.completed_first_name=!1,$scope.submitted_basic_information=!1,$scope.feedback_collapsed=!0,$scope.disable_submit=!1,$scope.show_progress_bar=!0,$scope.remove_progress_bar=!1,$scope.show_elig_progress_bar=!1,$scope.goingThroughEligibility=!1,$scope.submitting_app=!1,$scope.inputOtherUtils=!1,$scope.completed_items={name:!1,address:!1,telephone:!1,income:!1,household:!1,expenses:!1,ssn:!1,citizenship:!1,school_district:!1,township:!1,lived_at_duration:!1},$scope.eligibilityCompleted={household:!1,income:!1,citizenship:!1,expenses:!1},$scope.rating_options=[{label:"Select",value:-1},{label:"Definitely - 10",value:10},{label:"9",value:9},{label:"8",value:8},{label:"7",value:7},{label:"6",value:6},{label:"5",value:5},{label:"4",value:4},{label:"3",value:3},{label:"2",value:2},{label:"Absolutely Not - 1",value:1}],$scope.selected_rating=$scope.rating_options[0],$scope.show_progress=!("form.intro"===$state.current.name),$scope.completedName=function(){if($scope.snapForm.$valid&&$scope.formData.name.first_name&&$scope.formData.name.last_name)updateProgress("name"),$state.go("form.address");else{var field_invalid=$scope.snapForm.$error.required,which="";which=2==field_invalid.length?"both":"first_name"==field_invalid[0].$name?"first_name":"last_name",$scope.submitted_name=!0,$window.ga("send","event","name_validate","tap",which,1)}},$scope.checkboxAlert=function(){alert("You must check the box to certify your information is true before we can submit your application.")},$scope.completedAddress=function(){$scope.submitted_address=!0,$scope.snapForm.street_address.$pristine&&$scope.snapForm.zip.$pristine?(updateProgress("address"),$scope.has_address=!1,$state.go("form.lived-at-duration")):$scope.snapForm.street_address.$valid&&$scope.snapForm.zip.$valid&&$scope.formData.address.street_address&&$scope.formData.address.zip?(updateProgress("address"),$state.go("form.lived-at-duration")):!$scope.snapForm.street_address.$dirty&&!$scope.snapForm.zip.$dirty||""!==$scope.formData.address.street_address&&"undefined"!=typeof $scope.formData.address.street_address||!(null===$scope.formData.address.zip||"undefined"==typeof $scope.formData.address.zip&&$scope.snapForm.street_address.$valid&&$scope.snapForm.zip.$valid)||(updateProgress("address"),$scope.has_address=!1,$state.go("form.lived-at-duration"))},$scope.completedLivedAt=function(){$state.go($scope.formData.household&&$scope.formData.income?"form.ssn":"form.citizenship")},$scope.completedTelephone=function(){$scope.submitted_phone=!0,$scope.snapForm.$valid&&($scope.submitting_app=!0,updateProgress("telephone"),$scope.remove_progress_bar=!0,$scope.submitBasicApp(),calcBenefitService.calculate($scope.formData))},$scope.completedSSN=function(){$scope.submitted_ssn=!0,!$scope.formData.ssn&&$scope.snapForm.ssn.$valid?(showNoContactModal(),submitted_ssn=!1):$scope.formData.ssn&&$scope.snapForm.ssn.$valid&&(updateProgress("ssn"),$state.go("form.telephone"))},$scope.completedIncome=function(){$scope.submitted_income=!0,$scope.snapForm.income.$valid&&(updateProgress("income"),$state.go("form.resources"))},$scope.completedHousehold=function(){$scope.submitted_household=!0,$scope.snapForm.household.$valid&&(updateProgress("household"),$state.go("form.income"))},$scope.completedResources=function(){$scope.submitted_resources=!0,$scope.snapForm.total_resources.$valid&&(updateProgress("resources"),$state.go("form.expenses"))},$scope.completedExpenses=function(){$scope.submitted_expenses=!0,$scope.snapForm.expenses.$valid&&(updateProgress("expenses"),calcPotentialImmeditateBenefit()?($scope.show_progress_bar=!1,$state.go("form.quick-snap-1")):$state.go("form.ssn"))},$scope.addToPaidUtilities=function(type){"undefined"==typeof $scope.formData.utilities_paid&&($scope.formData.utilities_paid=[]),$scope.formData.utilities_paid.indexOf(type)<0?$scope.formData.utilities_paid.push(type):$scope.formData.utilities_paid.splice($scope.formData.utilities_paid.indexOf(type),1)},$scope.goToNextQuickSnap=function(num){$state.go(0==num?"form.quick-snap-eligible":"form.quick-snap-"+num)},$scope.inputOtherUtilities=function(){$scope.inputOtherUtils=!0},$scope.completedEligibilityIncome=function(){$scope.submitted_income=!0,$scope.snapForm.income.$valid&&(updateEligibilityProgress("income"),$state.go("form.resources"))},$scope.completedEligibilityHousehold=function(){$scope.submitted_household=!0,$scope.snapForm.household.$valid&&(updateEligibilityProgress("household"),$state.go("form.income"))},$scope.completedCitizenship=function(){$scope.submitted_citizenship=!0,$scope.formData.citizenship&&("none"==$scope.formData.citizenship?$state.go("form.ineligible"):$scope.goingThroughEligibility?(updateEligibilityProgress("citizenship"),$state.go("form.household")):(updateProgress("citizenship"),$state.go("form.household")))},$scope.completedNonCitizenship=function(){$scope.submitted_non_citizen=!0,$scope.formData.non_citizen&&($scope.goingThroughEligibility?(updateEligibilityProgress("citizenship"),$state.go("form.household")):(updateProgress("citizenship"),$state.go("form.household")))},$scope.completeEligibilityCalc=function(){$scope.submitted_expenses=!0,$scope.snapForm.expenses.$valid&&(calcBenefitService.calculate($scope.formData),updateProgress("expenses"),$scope.show_elig_progress_bar=!1,$scope.show_progress_bar=!0,$scope.remove_progress_bar=!0,$state.go("form.eligibility"))},$scope.$on("show-progress-bar",function(){console.log("show progress bar being called!!"),$scope.show_progress_bar=!0}),$scope.$on("dont-show-progress-bar",function(){$scope.show_progress_bar=!1}),$scope.$on("remove_progress_bar",function(){$scope.remove_progress_bar=!0}),$scope.$on("add-progress-bar",function(){$scope.remove_progress_bar=!1}),$scope.$on("show-elig-progress-bar",function(){$scope.show_elig_progress_bar=!0,$scope.show_progress_bar=!1,$scope.goingThroughEligibility=!0}),$scope.updateProgress=function(u){updateProgress(u)},$scope.submitBasicApp=function(){calcBenefitService.calculate($scope.formData),updateProgress("confirmation"),API.uploadBasicInfo($scope.formData,function(result,user_id){result&&user_id?($scope.formData.user_id=user_id,userDataFactory.userData.user.formData=$scope.formData,$scope.remove_progress_bar=!0,$state.go("form.basic-app-submitted")):($scope.submitting_app=!1,alert("Oops! Looks like something went wrong. Your form was NOT submitted. Please wait and try again."))})},$scope.submitFeedback=function(rating){$scope.formData.rating=rating,"-1"!=rating.value?API.uploadFeedback($scope.formData,function(result){result?$state.go("form.feedback-submitted"):alert("Oops Looks like something went wrong. Your feedback was NOT submitted. Please wait and try again.")}):alert("You must select a rating first!")},$scope.goBack=function(){"form.basic-app-submitted"!==$state.current.name&&window.history.back()},$rootScope.$on("$stateChangeStart",function(event,toState){"form.intro"==toState.name?($window.scrollTo(0,0),$scope.show_progress_bar=!0,$scope.goingThroughEligibility=!1,$scope.show_progress=!1):($scope.goingThroughEligibility&&"form.name"==toState.name&&($scope.show_progress_bar=!0),$scope.show_progress=!0)})}]),angular.module("formApp.interviewCtrl",["formApp.userDataFactory","formApp.apiFactory","formApp.jSignature","formApp.CalcBenefitService"]).controller("interviewCtrl",["$scope","$state","$rootScope","$location","$anchorScroll","$window","userDataFactory","API","calcBenefitService",function($scope,$state,$rootScope,$location,$anchorScroll,$window,userDataFactory,API,calcBenefitService){function updateProgress(name){$scope.stepsCompleted[name]=!0,$scope.int_progress=0;for(var x in $scope.stepsCompleted)$scope.stepsCompleted[x]===!0&&($scope.int_progress+=7.4)}function updateProgressStatus(){$scope.interview_progress_status=$scope.interviewCompleted.eligibility&&$scope.interviewCompleted.household&&$scope.interviewCompleted.income&&$scope.interviewCompleted.expenses?2:$scope.interviewCompleted.eligibility||$scope.interviewCompleted.household||$scope.interviewCompleted.income||$scope.interviewCompleted.expenses?1:0}function removeHouseholdMembersNotApplying(){for(var i=0;i<$scope.user.household-1;i++)"undefined"==typeof $scope.user.household_members[i]||0!=$scope.user.household_members[i].applying&&"undefined"!=typeof $scope.user.household_members[i].name||($scope.user.household_members[i].relation=" ")}function isEmpty(object){for(var i in object)if(object.hasOwnProperty(i))return!0;return!1}$scope.show_interview_progress=!1,$scope.int_progress=0,$scope.appSubmissionInProcess=!1,$scope.show_sig1=!1,$scope.show_sig2=!1,$scope.show_esig_info=!1,$scope.interview_progress_status=0,$scope.interview_steps=-1,$scope.user=userDataFactory.userData.user.formData,$scope.user.household_members="undefined"!=typeof $scope.user.household_members?$scope.user.household_members:{},$scope.interviewCompleted=userDataFactory.userData.interviewProgress,$scope.estimated_benefit=$scope.user.benefit_amount,$scope.today=new Date;var dd=$scope.today.getDate(),mm=$scope.today.getMonth()+1,yyyy=$scope.today.getFullYear();if(10>dd&&(dd="0"+dd),10>mm&&(mm="0"+mm),$scope.today=mm+"/"+dd+"/"+yyyy,$scope.user.disabled="no",$scope.minutes_saved=0,!isEmpty($scope.user.household_members))for(var i=0;i<$scope.user.household-1;i++)$scope.user.household_members[i]={applying:!1,income:0,show:!1,relation:"Select"};$scope.stepsCompleted={"int.dob":!1,"int.self-gender":!1,"int.marital_status":!1,"int.state_id":!1,"int.school":!1,"int.pregnant":!1,"int.household":!1,"int.household-applying":!1,"int.household-ssn":!1,"int.household-dob":!1,"int.household-relation":!1,"int.income-frequency":!1,"int.income-hours":!1,"int.income-household-amount":!1,"int.income-household-frequency":!1,"int.resources":!1,"int.expenses-mortgage":!1};var interviewMinutesCategory={eligibility:5,household:10,income:5,expenses:5};$scope.BoolOpts=[{value:!0,name:"Yes"},{value:!1,name:"No"}],$scope.YNOpts=[{value:"yes",name:"yes"},{value:"no",name:"no"}],$scope.Grade=[{value:"K",name:"Kindergarden"},{value:"1",name:"1st"},{value:"2",name:"2nd"},{value:"3",name:"3rd"},{value:"4",name:"4th"},{value:"5",name:"5th"},{value:"6",name:"6th"},{value:"7",name:"7th"},{value:"8",name:"8th"},{value:"9",name:"9th"},{value:"10",name:"10th"},{value:"11",name:"11th"},{value:"12",name:"12th"},{value:"Freshman",name:"College-Freshman"},{value:"Sophomore",name:"College-Sophomore"},{value:"Junior",name:"College-Junior"},{value:"Senior",name:"College-Senior"},{value:"Graduate",name:"Graduate"}],$scope.MaritalOpts=[{value:"Single",name:"Single"},{value:"Divorced",name:"Divorced"},{value:"Married",name:"Married"}],$scope.relationshipOptions=[{name:"Select",value:"Select"},{name:"Partner",value:"Partner"},{name:"Child",value:"Child"},{name:"Parent",value:"Parent"},{name:"Roommate",value:"Roommate"},{name:"Family",value:"Family"}],$scope.showHouseholdMember=function(k){for(var n in $scope.user.household_members)$scope.user.household_members[n].name==k&&($scope.user.household_members[n].show=!$scope.user.household_members[n].show)},$scope.hasApplyingMembers=function(){var isApplying=!1;for(var member in $scope.user.household_members)isApplying=isApplying||$scope.user.household_members[member].applying;return isApplying},$scope.updateMinutes=function(num){$scope.minutes_saved+=num},$scope.hasHouseholdMembers=function(){var has_members=!1;for(var member in $scope.user.household_members)has_members=has_members||$scope.user.household_members[member].name;return has_members},$scope.$on("int-main",function(meta,type){$scope.interviewCompleted[type]||$scope.updateMinutes(interviewMinutesCategory[type]),$scope.interviewCompleted[type]=!0,$scope.show_interview_progress=!1,calcBenefitService.calculate($scope.user),API.uploadPartialInterviewInfo($scope.user,function(result){result||alert("Oops! Looks like something went wrong. Your information was NOT submitted. Please refill your information")})}),$scope.$on("start-last-step",function(){API.uploadPartialInterviewInfo($scope.user,function(){})}),$scope.goToSignPage=function(){$state.go("int.interview-preview-sign"),$scope.show_sig1=!0},$scope.goToSig1=function(){$scope.show_sig1=!0,$location.hash("sig_container1"),$anchorScroll(),document.getElementById("image_wrapper_1").scrollLeft=467},$scope.goToSig2=function(){$scope.show_sig2=!0,$location.hash("sig_container2"),$anchorScroll(),document.getElementById("image_wrapper_5").scrollLeft=163},$rootScope.$on("$viewContentLoaded",function(){"int.interview-preview-sign"==$state.current.name&&($scope.goToSig1(),document.getElementById("topOfSignPage").style.display="none")}),$rootScope.$on("$stateChangeStart",function(event,toState,toParams,fromState){switch("int.main"!==fromState.name&&$scope.int_progress<100&&updateProgress(fromState.name),"int.main"==fromState.name&&($scope.show_interview_progress=!0),"int.main"==toState.name&&($scope.show_interview_progress=!1),toState.name){case"int.dob":case"int.self-gender":case"int.marital_status":case"int.state_id":case"int.school":case"int.pregnant":case"int.disabled":$scope.interview_steps=0;break;case"int.household":case"int.household-applying":case"int.household-ssn":case"int.household-dob":case"int.household-relation":$scope.interview_steps=1;break;case"int.income-frequency":case"int.income-hours":case"int.income-household-amount":case"int.income-household-frequency":$scope.interview_steps=2;break;case"int.resources":case"int.expenses-mortgage":$scope.interview_steps=3;break;case"int.info-confirmation":$scope.goToTop(),$scope.interview_steps=4;break;case"int.interview-preview-sign":case"int.info-review":$scope.scrollUpSignPage(),$scope.interview_steps=5;break;case"int.app-submission":$scope.interview_steps=6;break;case"int.main":$scope.interview_steps=-1;break;default:$scope.interview_steps=4}updateProgressStatus()}),$scope.getCity=function(){"undefined"!=typeof $scope.user.address.zip?API.getCityFromZip($scope.user.address.zip,function(err,data){$scope.user.address.city=err?" ":data.results[0].address_components[1].long_name.length>27?data.results[0].address_components[1].short_name:data.results[0].address_components[1].long_name}):$scope.user.address.city=" "},$scope.$on("process-app-data",function(){removeHouseholdMembersNotApplying(),$scope.getCity(),$scope.calcPersonsWithIncome()}),$scope.calcPersonsWithIncome=function(){$scope.personsWithIncome=[],"undefined"!=typeof $scope.user.monthly_income&&$scope.personsWithIncome.push({name:$scope.user.name.first_name+" "+$scope.user.name.last_name,amount:$scope.user.monthly_income,hours_per_month:"number"==typeof $scope.user.hours_wk&&"number"==typeof $scope.user.wk_month?$scope.user.wk_month*$scope.user.hours_wk:" "});for(var p in $scope.user.household_members)$scope.user.household_members.hasOwnProperty(p)&&$scope.user.household_members[p].applying===!0&&"number"==typeof $scope.user.household_members[p].income&&$scope.personsWithIncome.push({name:$scope.user.household_members[p].name,amount:$scope.user.household_members[p].income,hours_per_month:"number"==typeof $scope.user.household_members[p].hours_wk&&"number"==typeof $scope.user.household_members[p].wk_month?$scope.user.household_members[p].wk_month*$scope.user.household_members[p].hours_wk:" "});$scope.personsWithIncome=$scope.personsWithIncome.length>3?$scope.personsWithIncome.slice(0,3):$scope.personsWithIncome,console.log($scope.personsWithIncome)},$scope.submitSignedApplication=function(){"undefined"!=typeof $scope.user.sig1&&"undefined"!=typeof $scope.user.sig2?($scope.appSubmissionInProcess=!0,API.uploadPartialInterviewInfo($scope.user,function(result){result?$state.go("int.app-submission"):($scope.appSubmissionInProcess=!1,alert("Oops! Looks like something went wrong. Your form was NOT submitted. Please wait and try again."))})):alert("Note you must sign the form in both signature boxes in order to submit an application.")},$scope.getNumber=function(n){return new Array(n-1)},$scope.goBack=function(){"int.interview-preview-sign"===$state.current.name?(document.getElementById("topOfSignPage").style.display="block",$state.go("int.info-review")):window.history.back()},$scope.goToTop=function(){$location.hash("topOfSignPage"),$anchorScroll()},$scope.updateCurrentAndGoToNext=function(current,next){updateProgress(current),$state.go(next)},$scope.backToMainSign=function(index){var img_container=document.getElementById("image_wrapper"+index),header=document.getElementById("page_header"+index),pg_header=document.getElementById("sign_header"),tp_sign_page=document.getElementById("topOfSignPage");pg_header.style.display="block",tp_sign_page.style.display="block",header.style.display="none",img_container.style.display="none",img_container.style.bottom="0",$location.hash("topOfSignPage"),$anchorScroll()},$scope.expandThumbnail=function(index){var img_container=document.getElementById("image_wrapper"+index),header=document.getElementById("page_header"+index),pg_header=document.getElementById("sign_header"),tp_sign_page=document.getElementById("topOfSignPage");pg_header.style.display="none",tp_sign_page.style.display="none",header.style.display="block",header.style.position="absolute",header.style.top="0",header.style.left="0",img_container.style.display="block",img_container.style.position="absolute",img_container.style.top="50px",img_container.style.left="0",$location.hash("page_header"+index),$anchorScroll()},$scope.scrollDown=function(){$location.hash("confirm_anchor"),$anchorScroll()},$scope.scrollUpSignPage=function(){$location.hash("sign_header"),$anchorScroll()},$scope.debug=function(){console.log("Debug! "),console.log(interviewForm.state_id)}}]);